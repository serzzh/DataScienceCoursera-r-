library(data.table)
file <- 'repdata-data-StormData.csv'
data <- fread(file)
setwd("~/dsc/5. Reproducible Research/RepData_PeerAssessment2")
library(data.table)
file <- 'repdata-data-StormData.csv'
data <- fread(file)
library(plyr)
data$EVTYPE <- factor(data$EVTYPE)
totals <- ddply(data,.(EVTYPE), summarize, injuries=sum(INJURIES), fatalities=sum(FATALITIES), propdmg=sum(PROPDMG), cropdmg=sum(CROPDMG))
tot1<-totals[(totals$injuries>5000 | totals$fatalities>400),]
tot2<-totals[(totals$propdmg>100000 | totals$cropdmg>10000),]
library(ggplot2)
library(grid)
library(gridExtra)
p1 <- ggplot(tot1, aes(x=EVTYPE, y=injuries, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
p2 <- ggplot(tot1, aes(x=EVTYPE, y=fatalities, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g1<-grid.arrange(p1, p2, nrow=2)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g2<-grid.arrange(q1, q2, nrow=2)
tot2<-totals[(totals$propdmg>100000 | totals$cropdmg>20000),]
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g2<-grid.arrange(q1, q2, nrow=2)
tot2<-totals[(totals$propdmg>200000 | totals$cropdmg>30000),]
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g2<-grid.arrange(q1, q2, nrow=2)
tot2<-totals[(totals$propdmg>200000 | totals$cropdmg>40000),]
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g2<-grid.arrange(q1, q2, nrow=2)
tot2<-totals[(totals$propdmg>300000 | totals$cropdmg>40000),]
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g2<-grid.arrange(q1, q2, nrow=2)
tot2<-totals[(totals$propdmg>500000 | totals$cropdmg>50000),]
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g2<-grid.arrange(q1, q2, nrow=2)
print(g1)
g1<-grid.arrange(p1, p2, nrow=2)
totals <- ddply(data,.(EVTYPE), summarize, injuries=sum(INJURIES), fatalities=sum(FATALITIES), propdmg=sum(PROPDMG)/1000, cropdmg=sum(CROPDMG)/1000)
tot1<-totals[(totals$injuries>5000 | totals$fatalities>400),]
tot2<-totals[(totals$propdmg>500000 | totals$cropdmg>50000),]
p1 <- ggplot(tot1, aes(x=EVTYPE, y=injuries, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
p2 <- ggplot(tot1, aes(x=EVTYPE, y=fatalities, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g1<-grid.arrange(p1, p2, nrow=2)
print(g1)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g2<-grid.arrange(q1, q2, nrow=2)
print(g2)
tot2<-totals[(totals$propdmg>500000 | totals$cropdmg>50000),]
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g2<-grid.arrange(q1, q2, nrow=2)
print(g2)
tot2<-totals[(totals$propdmg>500 | totals$cropdmg>50),]
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g2<-grid.arrange(q1, q2, nrow=2)
print(g2)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank()) + ylab(Property Damage, Thousand USD)
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank()) + ylab(Crop Damage, Thousand USD)
g2<-grid.arrange(q1, q2, nrow=2)
print(g2)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank() + ylab(Property Damage, Thousand USD))
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank()) + ylab(Property Damage, Thousand USD)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank()) + ylab('Property Damage, Thousand USD')
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank()) + ylab('Crop Damage, Thousand USD')
g2<-grid.arrange(q1, q2, nrow=2)
totals <- ddply(data,.(EVTYPE), summarize, injuries=sum(INJURIES), fatalities=sum(FATALITIES), propdmg=sum(PROPDMG)/1000000, cropdmg=sum(CROPDMG)/1000000)
tot1<-totals[(totals$injuries>5000 | totals$fatalities>400),]
tot2<-totals[(totals$propdmg>0.5 | totals$cropdmg>0.05),]
p1 <- ggplot(tot1, aes(x=EVTYPE, y=injuries, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
p2 <- ggplot(tot1, aes(x=EVTYPE, y=fatalities, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g1<-grid.arrange(p1, p2, nrow=2)
print(g1)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank()) + ylab('Property Damage, Mil USD')
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank()) + ylab('Crop Damage, Mil USD')
g2<-grid.arrange(q1, q2, nrow=2)
print(g2)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank()) + ylab('Property Damage, Mil USD', size=10)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.y = element_text(size=10)) + ylab('Property Damage, Mil USD')
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank()) + ylab('Crop Damage, Mil USD')
g2<-grid.arrange(q1, q2, nrow=2)
p1 <- ggplot(tot1, aes(x=EVTYPE, y=injuries, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
p2 <- ggplot(tot1, aes(x=EVTYPE, y=fatalities, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank())
g1<-grid.arrange(p1, p2, nrow=2)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.y = element_text(size=10)) + ylab('Property Damage, Mil USD')
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.y = element_text(size=10)) + ylab('Crop Damage, Mil USD')
g2<-grid.arrange(q1, q2, nrow=2)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.y = element_text(size=10)) + xlab('Event Type') + ylab('Property Damage, Mil USD')
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.y = element_text(size=10)) + xlab('Event Type') + ylab('Crop Damage, Mil USD')
g2<-grid.arrange(q1, q2, nrow=2)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=10), axis.title.y = element_text(size=10)) + xlab('Event Type') + ylab('Property Damage, Mil USD')
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=10), axis.title.y = element_text(size=10)) + xlab('Event Type') + ylab('Crop Damage, Mil USD')
g2<-grid.arrange(q1, q2, nrow=2)
p1 <- ggplot(tot1, aes(x=EVTYPE, y=injuries, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=11), axis.title.y = element_text(size=11)) + xlab('Event Type')
p2 <- ggplot(tot1, aes(x=EVTYPE, y=fatalities, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=11), axis.title.y = element_text(size=11)) + xlab('Event Type')
g1<-grid.arrange(p1, p2, nrow=2)
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=11), axis.title.y = element_text(size=11)) + xlab('Event Type') + ylab('Property Damage, Mil USD')
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=11), axis.title.y = element_text(size=11)) + xlab('Event Type') + ylab('Crop Damage, Mil USD')
g2<-grid.arrange(q1, q2, nrow=2)
grid.text("title of this panel", vp = viewport(layout.pos.row = 1, layout.pos.col = 1:2))
g2<-grid.arrange(q1, q2, nrow=2)+grid.text("Figure 2. Most harmful events for the economy", vp = viewport(layout.pos.row = 2, layout.pos.col = 1:2))
g2<-grid.arrange(q1, q2, nrow=2)+grid.text("Figure 2. Most harmful events for the economy", vp = viewport(layout.pos.row = 0, layout.pos.col = 1:2))
g2<-grid.arrange(q1, q2, nrow=2)+grid.text("Figure 2. Most harmful events for the economy")
g1<-grid.arrange(p1, p2, nrow=2)+grid.text("Figure 1. Most harmful events. Population")
g2<-grid.arrange(q1, q2, nrow=2, main="Figure 2. Most harmful events. Economy")
g2<-grid.arrange(p1, p2, q1, q2, nrow=2, main="Figure 2. Most harmful events. Economy")
p1 <- ggplot(tot1, aes(x=EVTYPE, y=injuries, fill=EVTYPE)) + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=11), axis.title.y = element_text(size=11)) + xlab('Event Type')
p2 <- ggplot(tot1, aes(x=EVTYPE, y=fatalities, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=11), axis.title.y = element_text(size=11)) + xlab('Event Type')
## g1<-grid.arrange(p1, p2, nrow=2, main="Figure 1. Most harmful events. Population")
```
### Most harmful events affecting on on the economy
```{r}
q1 <- ggplot(tot2, aes(x=EVTYPE, y=propdmg, fill=EVTYPE))+ theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=11), axis.title.y = element_text(size=11)) + xlab('Event Type') + ylab('Property Damage, Mil USD')
q2 <- ggplot(tot2, aes(x=EVTYPE, y=cropdmg, fill=EVTYPE)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=11), axis.title.y = element_text(size=11)) + xlab('Event Type') + ylab('Crop Damage, Mil USD')
g2<-grid.arrange(p1, p2, q1, q2, nrow=2, main="Figure 1. Most harmful events. Population and Economy")
p1 <- ggplot(tot1, aes(x=EVTYPE, y=injuries, fill=EVTYPE)) + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=11), axis.title.y = element_text(size=11)) + xlab('Event Type')
p1
p1 <- ggplot(tot1, aes(x=EVTYPE, y=injuries)) + geom_bar(stat="identity") + theme(axis.ticks = element_blank(), axis.text.x = element_blank(), axis.title.x = element_text(size=11), axis.title.y = element_text(size=11)) + xlab('Event Type')
p1
zip_file <- 'repdata-data-StormData.csv.bz2'
unzip(zip_file)
setwd("~/dsc/5. Reproducible Research/RepData_PeerAssessment2")
zip_file <- 'repdata-data-StormData.csv.bz2'
file <- 'repdata-data-StormData.csv'
data <- fread(file)
zip_file <- 'repdata-data-StormData.csv.bz2'
unzip(zip_file)
bzfile(zip_file)
unlink(zip_file)
data <- fread(zip_file)
library(R.utils)
zip_file <- 'repdata-data-StormData.csv.bz2'
zip_file <- 'repdata-data-StormData.csv.bz2'
bunzip2(zip_file)
setwd("~/dsc/5. Reproducible Research/RepData_PeerAssessment2")
bunzip2(zip_file)
zip_file <- 'repdata-data-StormData.csv.bz2'
bunzip2(zip_file)
bunzip2(zip_file)
file <- 'repdata-data-StormData.csv'
file <- 'repdata-data-StormData.csv'
data <- fread(file)
zip_file <- 'repdata-data-StormData.csv.bz2'
bunzip2(zip_file, remove = FALSE)
file <- 'repdata-data-StormData.csv'
knit2html('Report.Rmd')
library(knitr)
knit2html('Report.Rmd')
library(data.table)
library(R.utils)
zip_file <- 'repdata-data-StormData.csv.bz2'
file <- 'repdata-data-StormData.csv'
if (!exists(file) & exists(zip_file) ){
bunzip2(zip_file, remove = FALSE)
} else if(!exists(file) & !exists(zip_file)){
print ('Please download https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2 file to source directory')
}
data <- fread(file)
library(data.table)
library(R.utils)
zip_file <- 'repdata-data-StormData.csv.bz2'
file <- 'repdata-data-StormData.csv'
if (!exists(file) & exists(zip_file) ){
bunzip2(zip_file, remove = FALSE)
} else if(!exists(file) & !exists(zip_file)){
print ('Please download https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2 file to source directory')
}
setwd("~/dsc/5. Reproducible Research/RepData_PeerAssessment2")
library(data.table)
library(R.utils)
zip_file <- 'repdata-data-StormData.csv.bz2'
file <- 'repdata-data-StormData.csv'
if (!exists(file) & exists(zip_file) ){
bunzip2(zip_file, remove = FALSE)
} else if(!exists(file) & !exists(zip_file)){
print ('Please download https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2 file to source directory')
}
exists(zip_file)
!exists(file)
file.exists(zip_file)
!file.exists(file)
!file.exists(zip_file)
library(R.utils, quietly = TRUE)
